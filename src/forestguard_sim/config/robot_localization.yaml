robot_localization:
  ros__parameters:
    use_sim_time: true            # ← add this (important for sim)

    publish_tf: true
    map_frame: map
    odom_frame: odom
    base_link_frame: base_link
    world_frame: odom

    # ===== Odometry from Gazebo bridge =====
    odom0: /odometry
    odom0_queue_size: 10
    odom0_differential: true       # ← set true (use deltas from wheel/odom)
    # Fuse planar pose x,y + planar twist vx, wz (NO orientation from /odometry)
    odom0_config: [ true,  true,  false,   # x, y, z
                    false, false, false,   # roll, pitch, yaw  ← set yaw to false
                    true,  false, false,   # vx, vy, vz        ← vy false for diff-drive
                    false, false, true,    # vroll, vpitch, vyaw (= wz)
                    false, false, false ]  # ax, ay, az

    # ===== IMU from Gazebo bridge =====
    imu0: /imu
    imu0_queue_size: 20
    imu0_differential: false
    imu0_remove_gravitational_acceleration: true
    # Use yaw & yaw-rate from IMU (2D mode ignores roll/pitch anyway)
    imu0_config:  [ false, false, false,   # x, y, z
                    false, false, true,    # roll, pitch, yaw
                    false, false, false,   # vx, vy, vz
                    false, false, true,    # vroll, vpitch, vyaw
                    false, false, false ]  # ax, ay, az

    sensor_timeout: 0.2
    transform_timeout: 0.05
    print_diagnostics: true
    reset_on_time_jump: true
